# 文档流程步骤

## 1. 目的

建立一套完整的文档驱动工作流程，确保AI结对编程项目从需求到交付的全过程可追溯、可复盘、可移交，通过系统化的文档管理实现规划驱动开发，避免项目失控和技术债务积累

## 2. 适用范围

适用于所有使用AI结对编程工具（如Claude Code、Codex CLI等）进行软件开发的项目，包括但不限于Web应用、游戏开发、API服务、工具脚本等各类软件项目

## 3. 注意事项

1. 文档即上下文，必须在项目启动时同步建立，而非事后补写
2. 所有文档必须存放在统一的记忆库目录（memory-bank）中，确保AI和人类共用同一真相源
3. 每次架构变更必须同步更新相关文档，文档滞后等同于系统失忆
4. 禁止生成单文件巨石代码，必须按模块化原则拆分实现
5. 每完成一个步骤必须进行验证测试，测试通过前不得进入下一步
6. 使用Git进行版本控制，每完成一个里程碑及时提交代码和文档变更
7. 遇到问题时优先查阅已有文档和上下文，避免重复询问已明确的信息

## 4. 相关模板或工具

1. **系统提示词模板**
   - `prompts/system_prompts/CLAUDE-V10.md` - AI行为规范与认知架构定义
   - `prompts/system_prompts/CLAUDE-V8.md` - 备用系统提示词版本

2. **编码提示词模板**
   - `prompts/coding_prompts/系统架构可视化生成Mermaid.md` - 架构可视化生成指南
   - `prompts/coding_prompts/标准化流程.md` - 流程标准化模板

3. **AI工具**
   - Claude Opus 4.5（Claude Code）
   - gpt-5.1-codex.1-codex（Codex CLI）
   - 其他支持的AI编程工具

4. **文档结构模板**
   - `memory-bank/project-context.md` - 项目上下文文档
   - `memory-bank/implementation-plan.md` - 实施计划文档
   - `memory-bank/progress.md` - 进度记录文档
   - `memory-bank/architecture.md` - 架构文档
   - `memory-bank/tech-stack.md` - 技术栈文档（如适用）

## 5. 流程步骤

### 阶段一：项目初始化与需求澄清

1. **创建项目目录结构**
   - 在本地文件系统创建项目根目录
   - 在项目根目录下创建 `memory-bank` 子目录
   - 初始化Git仓库（如尚未初始化）

2. **收集和整理需求**
   - 明确项目目标，用一句话描述核心功能
   - 列出非目标，明确项目边界和排除范围
   - 收集相关技术文档、API文档、设计稿等参考资料

3. **生成项目上下文文档**
   - 打开AI工具（Claude Code或Codex CLI）
   - 加载项目上下文文档生成提示词模板
   - 将需求、参考资料、技术约束等信息提供给AI
   - 要求AI生成 `memory-bank/project-context.md`，包含：
     - 项目概述与目标
     - 技术栈选择与理由
     - 核心功能模块划分
     - 数据模型与接口设计
     - 开发环境要求
     - 依赖项清单

4. **审查和完善上下文文档**
   - 人工审查生成的上下文文档
   - 补充遗漏的关键信息
   - 确认技术选型符合项目需求
   - 如有重大调整，要求AI重新生成或手动修正

### 阶段二：实施计划制定

5. **生成技术栈文档（如需要）**
   - 如果项目涉及新技术选型，要求AI生成 `memory-bank/tech-stack.md`
   - 文档应包含：推荐技术栈、选择理由、替代方案对比、学习资源链接

6. **生成实施计划**
   - 加载流程标准化提示词模板
   - 将项目上下文文档和技术栈文档提供给AI
   - 要求AI生成 `memory-bank/implementation-plan.md`，包含：
     - 分步骤实施指令（每步小而具体）
     - 每步的验收标准和测试方法
     - 步骤间的依赖关系
     - 禁止包含具体代码，只写清晰指令

7. **计划澄清与优化**
   - 要求AI阅读memory-bank中所有文档
   - 让AI提出需要澄清的问题（通常会有9-10个问题）
   - 逐一回答AI的问题
   - 要求AI根据回答更新 `implementation-plan.md`，使计划更完善

8. **创建进度和架构文档**
   - 创建空的 `memory-bank/progress.md` 文件，用于记录已完成步骤
   - 创建空的 `memory-bank/architecture.md` 文件，用于记录架构决策和文件职责

### 阶段三：分步执行与验证

9. **执行第一步**
   - 打开新的AI对话会话（避免上下文污染）
   - 提示AI：阅读memory-bank所有文档，然后执行实施计划第1步
   - 明确要求：在用户验证测试通过前，不要开始第2步
   - 使用"Ask"模式或"Plan Mode"先让AI展示执行计划，确认无误后再执行

10. **验证第一步结果**
    - 运行计划中指定的测试命令或验收方法
    - 检查代码是否符合模块化原则（非单文件巨石）
    - 验证功能是否符合预期
    - 如有问题，要求AI修复，修复后重新验证

11. **更新进度和架构文档**
    - 验证通过后，要求AI更新 `progress.md`，记录：
      - 完成的步骤编号和名称
      - 实现的功能点
      - 创建或修改的文件列表
      - 遇到的难点和解决方案
    - 要求AI更新 `architecture.md`，记录：
      - 新增文件的职责和用途
      - 模块间的依赖关系
      - 关键设计决策和理由

12. **提交代码变更**
    - 使用Git提交当前步骤的代码变更
    - 提交信息应清晰描述本步骤完成的功能
    - 如有文档更新，一并提交

13. **循环执行后续步骤**
    - 打开新的AI对话会话（清理上下文）
    - 提示AI：阅读memory-bank所有文件，阅读progress.md了解之前的工作进度，然后继续实施计划第N步（N为下一步编号）
    - 重复步骤9-12的流程，直到所有计划步骤完成

### 阶段四：文档同步与架构维护

14. **持续更新架构文档**
    - 每次创建、删除、移动文件或目录时
    - 每次模块重组、层级调整、职责重新划分时
    - 必须同步更新 `memory-bank/architecture.md` 或项目根目录的 `CLAUDE.md`
    - 文档应包含：目录结构树、文件职责说明、模块依赖关系、关键架构决策

15. **维护项目上下文文档**
    - 当项目需求发生重大变更时
    - 当技术栈需要调整时
    - 当核心功能模块划分改变时
    - 及时更新 `project-context.md`，保持上下文与项目现状一致

### 阶段五：功能扩展与迭代

16. **添加新功能**
    - 为每个新功能创建独立的 `feature-implementation.md` 文件
    - 文件应包含：功能描述、实施步骤、测试方法
    - 按照步骤9-13的流程执行新功能开发
    - 完成后更新主实施计划和进度文档

17. **处理Bug和问题**
    - 收集错误信息：错误类型、发生时机、触发条件、堆栈信息
    - 要求AI从现象层、本质层、哲学层三个维度分析问题
    - 优先使用Git回退到上一个稳定版本（如需要）
    - 修复后更新progress.md记录问题和解决方案

### 阶段六：项目交付与复盘

18. **最终文档整理**
    - 检查所有memory-bank文档是否完整和最新
    - 生成项目README.md，包含：项目概述、快速开始、架构说明、开发指南
    - 如有需要，生成API文档、部署文档等专项文档

19. **项目复盘**
    - 回顾整个开发流程
    - 总结文档驱动的效果和不足
    - 记录经验教训，优化后续项目的文档流程
    - 更新标准化流程模板（如适用）

20. **知识沉淀**
    - 将项目中的优秀实践提取为可复用的提示词模板
    - 更新系统提示词库（如发现改进点）
    - 分享项目经验到团队知识库

